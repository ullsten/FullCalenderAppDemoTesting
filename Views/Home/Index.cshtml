<!DOCTYPE html>
<html lang='en'>
<head>
    <meta charset='utf-8' />
    @*<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.css' />*@

    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/5.10.1/main.min.css' />
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.10.2/fullcalendar.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js'></script>

    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js'></script>
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css' />
    <script>

        document.addEventListener('DOMContentLoaded', function () {
            var calendarEl = document.getElementById('calendar');
            var calendar = new FullCalendar.Calendar(calendarEl, {

                timeZone: 'Europe/Stockholm',
                locale: 'sv', // Set the locale to Swedish

                initialView: 'dayGridMonth',
                headerToolbar: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'dayGridMonth,timeGridWeek,timeGridDay',
                },
                buttonText: {
                    prev: 'Föregående',
                    next: 'Nästa',
                    today: 'Idag',
                    month: 'Månad',
                    week: 'Vecka',
                    day: 'Dag',
                },

                //set default color for event (bordercolor ?)
                eventColor: 'green',


                //set color for event from value in database
                eventDidMount: function (info) {
                    // Get the event object
                    var event = info.event;

                    // Set the background color for the event using the themeColor property
                    event.setProp('backgroundColor', event.extendedProps.themeColor);
                },

                editable: true, // Allow events to be dragged and resized
                selectable: true, // Enable date selection

                // Add events/fetch from action/database
                events: {
                    url: 'Home/GetEvents',
                    failure: function () {
                        alert('Failed to retrieve events. Please try again later');
                    }  
                },

                // Handle date selection
                select: function (info) {
                    // Get the selected start and end dates
                    var start = info.startStr;
                    var end = info.endStr;

                    // Set the start and end dates in the event creation form
                    document.getElementById('start').value = start;
                    document.getElementById('end').value = end;

                    // Show the event creation modal
                    $('#eventModal').modal('show');
                }
            });
            calendar.render();
        });

    </script>
</head>
<body>

    @*Display calandar*@
    <div id='calendar'></div>

    @*Event creation modal*@
    <div class="modal fade" id="eventModal" tabindex="-1" aria-labelledby="eventModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="eventModalLabel">Create Event</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    @*Json action*@
                    @*action="Home/SaveEvent"*@
                    @*asp-action="Create" asp-controller="Events""*@

                    <form id="createEventForm" method="post" action="Home/SaveEvent">
                        <input type="text" name="Subject" placeholder="Subject" required />
                        <input type="hidden" id="start" name="Start" />
                        <input type="hidden" id="end" name="End" />
                        <input type="text" name="Description" placeholder="Description" />
                        <input type="text" name="ThemeColor" placeholder="Color" />
                        <input class="form-check-input" type="checkbox" name="IsFullDay" /> Full day

                        <input type="submit" value="Create Event" />
                    </form>
                </div>
            </div>
        </div>
    </div>


    @*Button to show the event creation form*@
@*    <button id="showEventFormButton">Create Event</button>

    <script>
        // Show the event creation form when the button is clicked
        document.getElementById('showEventFormButton').addEventListener('click', function () {
            document.getElementById('eventForm').style.display = 'block';
        });
    </script>*@
</body>
</html>